---
title: "Juvenile snowshoe hair: exploratory report"
author: "Drew Andersen"
date: "11/10/2021"
output: html_document
---

```{r setup, include = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

#attach packages
library(tidyverse)
library(janitor)
library(here)
library(effsize)
library(lubridate)
library(kableExtra)
library(ggthemes)
```
# A. Overview

This report provides an exploratory analysis of juvenile snowshoe hares in Bonanza Creek Experimental Forest (Long Term Ecological Research site) located in central Alaska from 1998-2012. Snowshoe hares are a significant prey species in northern boreal forests and have been found to experience population fluctuations of 8-11 years (Kielland). This miniature report will explore count and sizes of juvenile snowshoe hares and compare these variables in relation to the sex and hind foot length of the hare. 

# B. Data and methods

Snowshoe hare body measurements were collected by the Bonanza Creek LTER and made available for this analysis by Knut Kielland and other investigators at Bonanza Creek LTER site. This data contains over 3000 hare observations, 371 of which are for juvenile hares and the subject of this analysis. After an analysis of the juvenile hare subset and data visualizations for the body masses of male and female juvenile hares, the masses for the two groups are compared by two-sample t-tests using a significance level ($\alpha$) of 0.05 throughout. The difference between sexes is described by Cohen's *d* efect size. The relationship between hind foot length and weight is explored using simple linear regression. All analyses are in R version 4.1.1 using RStudio version 1.4.1717. 

```{r read in}
#Read in and clean data
snowshoe <- read_csv(here("data","bonanza_hares.csv"))
```
# C. Juvenile hare initial investigation:
## 1. Annual juvenile hare trap counts
```{r task i, fig.align="center", fig.cap = "**Figure 1.** Annual juvenile hare trap count in Bonanza Creek Experimental Forest between 1998-2012. This total reflects the number of juvenile hares trapped each year during this study."}
#subset for data visualization 
snowshoe_count <- snowshoe %>% 
  filter(age == "j") %>% #filter for juveniles
  mutate(date_new = mdy(date)) %>% 
  mutate(year = year(date_new)) %>% 
  group_by(year) %>% 
  summarize(trap_count = n()) 

#data_visualization
ggplot(data = snowshoe_count, aes(x = year, y = trap_count)) +
  geom_col(fill = "dodgerblue4") +
  labs(y = "Total Hares Trapped",
       x = NULL) +
  scale_x_continuous(breaks = 1998:2012) + #see all dates
  scale_y_continuous(breaks = c(0, 25,50, 75, 100)) +
  theme(text = element_text(color = "black")) +
  theme_hc() 

#in text referencing
trap_max <- max(snowshoe_count$trap_count)
trap_min <- min(snowshoe_count$trap_count)
trap_mean <- round(mean(snowshoe_count$trap_count),0)
```
The number of juvenile snowshoe hares trapped annually during this study differed greatly from year to year. The maximum and minimum number of hares trapped during this study was `r trap_max` and `r trap_min`, respectively. Over the 14 year period, the average number of juveniles trapped was `r trap_mean`. It appears that the juvenile hare population experiences population spikes every 2-4 years that increase their population by 2-3 times. Overall it appears that the population is declining, but this data set does not encompass a large enough time span to confirm this trend. In addition, incongruities in the sampling process from year to year may have contributed to these large differences seen annually. These sampling errors can be attributed to the time of study, the number of traps, and the frequency of monitoring these traps within the research site. 

## 2. Juvenile hare weights 
```{r task ii, fig.align="center", echo = FALSE, fig.width = 7, fig.cap = "**Figure 2.** Juvenile hare weight distributions by site and sex. The black square on each series indicates the mean of that particular series."}
#subset for data visualization 
snowshoe_weight <- snowshoe %>% 
  mutate(site= case_when( #converting acronyms to full names
    grid == "bonrip" ~ "Bonanza Riparian",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonbs" ~ "Bonds")) %>% 
  mutate(sex = case_when(
    sex == "m" ~ "Male",
    sex == "f" ~ "Female",
    is.na(sex) ~ "Unconfirmed")) %>% 
  drop_na(weight) %>% #dropping rows with NA weights 
  filter(weight != 0, #filtering for rows with non zero values
         age == "j") #filtering for juveniles
 
#jitter plot of mass distributions by sex and site
ggplot(data = snowshoe_weight, aes(sex,weight)) +
  geom_jitter(aes(color = sex), size = 1.75, width = .35) +
  facet_wrap(~site) +
  scale_color_manual(values = c("#FF00FF","#0000FF","#008080")) +
  scale_x_discrete(breaks = NULL) + #drop redundant labels
  scale_y_continuous(breaks = seq(from = 400, to = 1600, by = 200)) + #scaling y-axis at 200 g interval
  labs(y = "Body Mass (g)",
       x = NULL,
       color = NULL) + 
    stat_summary(fun=mean, 
               geom="point", 
               shape=15, 
               size=2.5, 
               color="black", 
               fill="black") +
  theme_hc()
```
The Bonanza Riparian & Mature areas share similar mean values for both male and female hares, while the Bonds area demonstrates larger mean values for each sex. However, this difference in means can be attributed to a lack of available data for that area.

## C. Juvenile Hare Weight Comparison
```{r}
#creating table for summarry statistics 
snowshoe_stats <- snowshoe_weight %>% 
  filter(sex != "Unconfirmed") %>% 
  group_by(sex) %>% 
  summarize(sample_size = n(),
            mean = round(mean(weight, na.rm = TRUE),0),
            std_dev = round(sd(weight, na.rm = TRUE),0))

#formatting table above for knitted doc
snowshoe_stats %>% 
  kable(col.names = c("Sex", #renaming the column names from their variable names
                      "Sample Size", 
                      "Mean Weight (g)",
                      "Standard Deviation (g)"),
        caption = "Table 1. Summary statistics for male and female juvenile hare weights.") %>% 
  kable_styling(full_width = FALSE)
```

```{r}
#creation of vectors for t-test
snow_male <- snowshoe_weight %>% 
  filter(sex == "Male") %>% 
  pull(weight)

snow_female <- snowshoe_weight %>% 
  filter(sex == "Female") %>% 
  pull(weight)

snow_t <- t.test(snow_male, snow_female)
mean_diff <- round(snow_t$estimate[2] - snow_t$estimate[1],0)

snow_cohen <- cohen.d(snow_male, snow_female)
```

```{r}
ggplot(data = snowshoe_weight, aes(x = weight)) +
  geom_histogram(bins = 18) +
  facet_wrap(~sex)

ggplot(data = snowshoe_weight, aes(sample = weight)) +
  geom_qq() +
  facet_wrap(~sex)
```

## D. Weight and Hind Foot Length 
```{r}
ggplot(data = snowshoe, aes(x = hindft , y = weight)) +
  geom_point(aes(color = "cyan3"), size = .75)+
  labs(x = "Hind Foot Length(mm)",
       y = "Body Mass (g)",
       caption = "") +
  theme_classic()

snowshoe_lm <- lm(weight ~ hindft, data = snowshoe)
```

#### Summary


#### Citations

Data citation: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14
