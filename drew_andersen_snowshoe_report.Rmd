---
title: "Snowshoe Hare Analysis"
author: "Drew Andersen"
date: "11/7/2021"
output: html_document
---

```{r setup, include = TRUE, message = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

#attach packages
library(tidyverse)
library(janitor)
library(here)
library(effsize)
library(lubridate)
library(kableExtra)
```
# 1. Overview

This report provides an exploratory analysis of juvenile snowshoe hares in Bonanza Creek Experimental Forest (Long Term Ecological Research site) from 1998-2012. This miniature report will explore count and sizes of juvenile snowshoe hares and compare these variables in relation to the sex and hind foot length of the hare. 

# 2. Data and methods

Snowshoe hare body measurements were collected by the Bonanza Creek LTER and made available for this analysis by Knut Kielland and other investigators at Bonanza Creek LTER site (see map). This data contains over 3000 hare observations, 371 of which were juvenile and the subject of this analysis. 

Penguin structural size measurements were collected and made available by Dr. Kristen Gorman and colleagues at the Palmer Station Long Term Ecological Research (LTER) network site in Palmer Archipelago, Antarctica (see map from Gorman et al. (2014) in Figure 1). The data contain observations for 344 unique nesting penguins, collected over three seasons (2007, 2008, 2009). Following exploratory data visualization, flipper lengths between male and female penguins are by two-sample t-tests using a significance level ($\alpha$) of 0.05 throughout. Differences between groups are described by Cohen's *d* effect size. The relationship between flipper length and body mass is explored by simple linear regression. All analyses are in R version 4.0.2 using RStudio version 1.3.1056.
```{r}
#Read in and clean data
snowshoe <- read_csv(here("data","bonanza_hares.csv"))
```

# 3. Preliminary results

## A. Juvenile hare initial investigation:
```{r}
#subset for data visualization 
snowshoe_count <- snowshoe %>% 
  filter(age =="j") %>% 
  mutate(date_new = mdy(date)) %>% 
  mutate(year = year(date_new)) %>% 
  group_by(year) %>% 
  summarize(trap_count = n())

#in text referencing
trap_max <- max(snowshoe_count$trap_count)
trap_min <- min(snowshoe_count$trap_count)
trap_mean <- round(mean(snowshoe_count$trap_count),0)
trap_median <- median(snowshoe_count$trap_count)

#data_visualization
ggplot(data = snowshoe_count, aes(x = year, y = trap_count)) +
  geom_col(fill = "dodgerblue4") +
  labs(title = "Juvenile Hare Trap Count",
       y = "Total Hares Trapped",
       x = NULL,
       caption = "Fig 1. Annual juvenile hare trap count between 1998-2012. This total reflects the number of juvenile hares trapped each year during this study.") +
  scale_x_continuous(breaks = 1998:2012) +
  theme_linedraw() 
```

## B. Juvenile Hare Weights 
```{r fig.align="center", echo = FALSE, fig.width = 7}
#subset for data visualization 
snowshoe_weight <- snowshoe %>% 
  mutate(site= case_when(
    grid == "bonrip" ~ "Bonanza Riparian",
    grid == "bonmat" ~ "Bonanza Mature",
    grid == "bonbs" ~ "Bonds")) %>% 
  mutate(sex = case_when(
    sex == "m" ~ "Male",
    sex == "f" ~ "Female",
    is.na(sex) ~ "Unconfirmed")) %>% 
  drop_na(weight) %>%
  filter(weight != 0,
         age == "j")
 
#histogram of weight distributions by sex and site
ggplot(data = snowshoe_weight, aes(sex,weight)) +
  geom_jitter(aes(color = sex), size = 2.5, width = .35) +
  facet_wrap(~site) +
  scale_color_manual(values = c("maroon3","royalblue3","springgreen4")) +
  labs(title = "Juvenile Hare Weight by Trap Site",
       y = "Body Mass (g)",
       x = NULL,
       caption = "Fig 2. Juvenile hare weight distribution by site and sex. The group marked NA") +
    theme(legend.position = "none") +
    stat_summary(fun=mean, 
               geom="point", 
               shape=20, 
               size=6, 
               color="black", 
               fill="black")
```

## C. Juvenile Hare Weight Comparison
```{r}
#creating table for summarry statistics 
snowshoe_stats <- snowshoe_weight %>% 
  filter(sex != "Unconfirmed") %>% 
  group_by(sex) %>% 
  summarize(sample_size = n(),
            mean = round(mean(weight, na.rm = TRUE),0),
            std_dev = round(sd(weight, na.rm = TRUE),0))

#formatting table above for knitted doc
snowshoe_stats %>% 
  kable(col.names = c("Sex", #renaming the column names from their variable names
                      "Sample Size", 
                      "Mean Weight (g)",
                      "Standard Deviation (g)"),
        caption = "Table 1. Summary statistics for male and female juvenile hare weights.") %>% 
  kable_styling(full_width = FALSE)
```

```{r}
#creation of vectors for t-test
snow_male <- snowshoe_weight %>% 
  filter(sex == "Male") %>% 
  pull(weight)

snow_female <- snowshoe_weight %>% 
  filter(sex == "Female") %>% 
  pull(weight)

snow_t <- t.test(snow_male, snow_female)
mean_diff <- round(snow_t$estimate[2] - snow_t$estimate[1],0)

snow_cohen <- cohen.d(snow_male, snow_female)
```

```{r}
ggplot(data = snowshoe_weight, aes(x = weight)) +
  geom_histogram(bins = 18) +
  facet_wrap(~sex)

ggplot(data = snowshoe_weight, aes(sample = weight)) +
  geom_qq() +
  facet_wrap(~sex)
```

## D. Weight and Hind Foot Length 
```{r}
ggplot(data = snowshoe, aes(x = hindft , y = weight)) +
  geom_point(aes(color = "cyan3"), size = .75)+
  labs(x = "Hind Foot Length(mm)",
       y = "Body Mass (g)",
       caption = "") +
  theme_classic()

snowshoe_lm <- lm(weight ~ hindft, data = snowshoe)
```

#### Summary


#### Citations

Data citation: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14
